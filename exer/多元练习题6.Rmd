---
title: "6 判别分析"
author: "王斌会"
date: "2020年2月1日"
output: word_document
---

```{r setup}
rm(list=ls())                               #清理内存
options(digits=4)                           #输出结果位数
par(mar=c(4,4,2,1))                         #设置图片输出位置
library(MASS)
library(mvstats)
library(openxlsx)
library(knitr)
```


## 6.1   
　　**考虑两个数据集$x_1=\begin{bmatrix}3 & 7\\ 2 & 4\\ 4 & 7\end{bmatrix}$,$x_2=\begin{bmatrix}6 & 9\\ 5 & 7\\ 4 & 8\end{bmatrix}$,其中$\bar{x_1}=\begin{bmatrix}3\\ 6\end{bmatrix}$,$\bar{x_2}=\begin{bmatrix}5\\ 8\end{bmatrix}$,$S_p=\begin{bmatrix}1 & 1\\ 1 & 2\end{bmatrix}$。**    
             
### 6.1.1    
　　**计算Fisher线性判别函数。** 　　　        
　　首先将数据集$x_1$、$x_2$、$\bar x_1$、$\bar x_2$、和合并协方差阵$S_p$输入：    
```{r read6.1,comment=''}

```

　　设判别函数为$Y=a_1'X=(\bar x_1-\bar x_2)'S_p^{-1}X$   
```{r block6.1.1,comment=''}
 
```

### 6.1.2     
　　**应用Bayes法则，在相同先验概率和相同代价下将观测值$x_0'=(2,7)$分类到总体$G_1$或$G_2$。**        
　　将数据汇总成数据框的形式：       
```{r block6.1.2,comment=''}

```

　　应用Bayes准则并分类：        
```{r block6.1.3,comment=''}

```

## 6.2    
　　**设$n_1=11$个和$n_2=12$个观测值分别取自两个随机变量$X_1$和$X_2$。假定这两个变量服从二元正态分布，且有相同的协方差矩阵：**    
$$\bar{x_1}=\begin{bmatrix}-1\\ -1\end{bmatrix},\bar{x_2}=\begin{bmatrix}2\\ 1\end{bmatrix},S_p=\begin{bmatrix}7.3 & -1.1\\ -1.1 & 4.8\end{bmatrix}$$    

　　首先将数据集$\bar x_1$、$\bar x_2$、和合并协方差阵$S_p$输入   
```{r read6.2,comment=''}

```

### 6.2.1    
　　**构造样本的Fisher线性判别函数。**       
　　设判别函数为$Y=a_2'X=(\bar x_1-\bar x_2)'S_p^{-1}X$
```{r block6.2.1,comment=''}

```

### 6.2.2   
　　**将观测值$x_0'=(0,1)$分配到总体$G_1$或$G_2$（假定有等代价和等先验概率）。**     
　　可以直接判别界点然后将$x_0'$带入判别：    
```{r block6.2.2,comment=''}


```

## 6.3     
　　**以舒张期血压和血浆胆固醇含量预测被检验者是否患冠心病。测得15名冠心病患者和16名健康人的舒张压$X_1$(mmHg)及血浆胆固醇含量$X_2$(mg/dL)，结果见下表。**     

　　首先读取数据：  
```{r read6.3,comment=''}

```

### 6.3.1    
　　**对每一组数据用不同的符号作两变量的散点图，观察它们在平面上的散布情况，并判断对该组数据做判别分析是否合适。**          
```{r plot6.3,comment=''}

```

### 6.3.2    
　　**分别建立距离判别（等方差阵和不等方差阵）、Fisher判别和Bayes判别分析模型，计算各自的判别符合率，以此确定哪种判别方法最恰当。**    
　　假设两类总体都服从正态分布。    
（a）距离判别（等方差阵），与Fisher判别、先验概率为频率的Bayes判别等价
```{r block6.3.1,comment=''}

```

（b）距离判别（不等方差阵）     
```{r block6.3.2,comment=''}

```

（c）先验概率相同的Bayes判别     
```{r block6.3.3,comment=''}

```

### 6.3.3    
　　**绘制线性判别函数图**   
```{r block6.3.4,comment=''}

```

## 6.4    
　　**对于A股市场2009年陷入财务困境的上市公司（ST公司），我们收集了8间ST公司陷入财务困境前的一年（2008年）的财务数据，同时对于财务良好的公司（非ST公司），收集了同一时期8间非ST公司对应的财务数据。数据涉及四个变量：资产负债率$x_1$、流动资产周转率$x_2$、总资产报酬率$x_3$和营业收入增长率$x_4$。类别变量G中2代表ST公司，1代表非ST公司。**     
```{r read6.4,comment=''}

```

### 6.4.1    
　　**分别建立线性判别函数、非线性判别函数和Bayes判别分析模型，计算各自的判别符合率，确定哪种判别方法最恰当。**    
（a）线性判别    
```{r block7.4.1,comment=''}

```

（b）非线性判别    
```{r block6.4.2,comment=''}

```

（c）Bayes判别        
　　假设两类总体均服从正态分布。则先验概率为频率的Bayes与线性判别的判别结果相同，下面建立先验概率相同的Bayes判别分析模型。    
　　
```{r block6.4.3,comment=''}

```

### 6.4.2   
　　**某公司2008年财务数据为：$x_1=78.356,x_2=0.8895,x_3=1.800,x_4=14.1022$。试判定2009年该公司是否会陷入财务困境。**        
```{r block6.4.4,comment=''}

```

## 6.5    
　　**植物分类之判别分析：费歇（Fisher）于1936年发表的鸢尾花（Iris）数据被广泛的作为判别分析的经典例子。数据是对3种鸢尾花（g）：刚毛鸢尾花（第一组）、变色鸢尾花（第二组）和弗吉尼亚鸢尾花（第三组）各抽取一个容量为50的样本，测量其花萼长（sepallen，$x_1$）、花萼宽（sepalwid，$x_2$）、花瓣长（petallen，$x_3$）、花瓣宽（petalwid，$x_4$），单位为mm，数据见下表。**     

　　首先读取数据：   
```{r read6.5,comment=''}

```

### 6.5.1   
　　**非线性判别**      
```{r block6.5.1,comment=''}

```

### 6.5.2    
　　**线性判别与Bayes判别**         
```{r block7.5.2,comment=''}

```
