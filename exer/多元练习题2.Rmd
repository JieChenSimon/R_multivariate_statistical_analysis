---
title: "《多元统计分析及R语言建模》第2章"
author: "王斌会"
date: "2020.2.1"
output:
  word_document: default
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup}
rm(list=ls())                               #清理内存
options(digits=4)                           #输出结果位数
par(mar=c(4,4,2,1))                         #设置图片输出位置
library(openxlsx)
library(knitr)
```

## 2.1      
　　**对下面的相关系数矩阵，试用R语言求其逆矩阵、特征根和特征向量。要求写出R语言计算函数。**
$$R=\begin{bmatrix}
1.00&0.80&0.26&0.67&0.34\\
0.80&1.00&0.33&0.59&0.34\\
0.26&0.33&1.00&0.37&0.21\\
0.67&0.59&0.37&1.00&0.35\\
0.34&0.34&0.21&0.35&1.00
\end{bmatrix}$$

```{r read2.1,comment=''}
R=matrix(c(1.00,0.80,0.26,0.67,0.34,0.80,1.00,0.33,0.59,0.34,0.26,0.33,
1.00,0.37,0.21,0.67,0.59,0.37,1.00,0.35,0.34,0.34,0.21,0.35,1.00),nrow=5,ncol=5);R           #生成矩阵R
```

```{r block2.1,comment=''}
R.=solve(R);R.       
R.e=eigen(R,symmetric = T);R.e    
```

## 2.2   
　　**某厂对50个计件工人某月份工资进行登记，获得以下原始资料（单位：元）。试按组距为300编制频数表，计算频数、频率和累计频率，并绘制直方图。**

1465 1760 1985 2270 2980 1375 1735 1940 2220 2670 1405 1755 1965
2240 2820 1295 1645 1880 2110 2550 1355 1710 1910 2190 2600 1265 1625
1865 2095 2520 1225 1605 1845 2040 2430 1175 1835 2030 2370 1000 1535
1810 2010 2290 1125 1575 1815 2030 2320

### 2.2.1
　　**写出R语言程序。**   
  
```{r read2.2,comment=''}
d2.2=read.xlsx('mvexer5.xlsx',sheet='E2.2');tail(d2.2)  #读取数据并显示后六行
```
　　先对数据进行简单的统计分析：
```{r block2.2.1,comment=''}
min(d2.2)
max(d2.2)
```
　　可以得到某月份最低工资为1000元,最高工资为2980元。

　　画出组距为300的直方图：
```{r block2.2.2,,comment=''}
H1=hist(d2.2$X,breaks=seq(900,3000,300))     #以组距为300画直方图
```

　　编制频数表，列出频数、频率和累计频率：     
```{r block2.2.3,,comment='',warning=FALSE}
names(H1)
data.frame('组中值'=H1$mids,'频数'=H1$counts,'频率'=H1$density*300,'累计频率'=cumsum(H1$density*300))
```

### 2.2.3    
　　**用R语言作正态概率图并分析之：**
```{r block2.3.5,comment=''}
qqnorm(d2.2$X);qqline(d2.2$X)        
```

　　由正态概率图可以看出数据点基本是一条直线，因此数据可以近似看作正态分布。

## 2.3   
　　**以下是一份关学生是否抽烟与每天学习时间长短关系的调查数据，试用R语言对其进行基本统计分析。**

```{r read2.3,comment=''}
d2.3=read.xlsx('mvexer5.xlsx',sheet='E2.3');d2.3  #读取数据
```

　　对数据进行简单的统计分析：
```{r block2.3.1,comment=''}
dim(d2.3);names(d2.3)                       
str(d2.3)                                   
```

```{r block2.3.2,comment=''}
summary(d2.3)                               
```
　　可以看到抽取学生中4位不抽烟，6位抽烟，每天学习时间小于5小时的有3位，5-10小时的有4位，超过10小时的有3位，抽烟情况和学习时间分别的分布比较均匀。

## 2.4　　　　
　　**试编制进行计量数据频数表分析的R语言函数。**
```{r block2.4,comment=''}
ch=function(X){
    H=hist(X)
    n=H$breaks[2]-H$breaks[1]
    c=data.frame('组中值'=H$mids,'频数'=H$counts,'频率'=H$density*n,'累计频率'=cumsum(H$density*n))
    c
}
ch(d2.2$X)
```
