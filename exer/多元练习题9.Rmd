---
title: "9 因子分析"
author: "王斌会"
date: "2020年2月1日"
output: word_document
---

```{r setup}
rm(list=ls())                               #清理内存
options(digits=4)                           #输出结果位数
par(mar=c(4,4,2,1))                         #设置图片输出位置
library(MASS)
library(mvstats)
library(openxlsx)
library(knitr)
```

## 9.1    
　　**证明对标准化变量$Z_1$、$Z_2$和$Z_3$，**
$$R=\begin{bmatrix}
    1  & 0.63 & 0.45\\
  0.63 &  1   & 0.35\\
  0.45 & 0.35 &  1
    \end{bmatrix}$$     
**可以由$m=1$的正交因子模型**
$$\begin{cases}
   Z_1=0.9F_1+\varepsilon_1\\
   Z_2=0.7F_1+\varepsilon_2\\
   Z_3=0.1F_1+\varepsilon_3
  \end{cases}$$    
**生成，这里**$var(F_1)=1，cov(\varepsilon,F)=0$,    
$$cov(\varepsilon)=\Sigma_\varepsilon=
  \begin{bmatrix}
    0.19 &   0  &  0  \\
      0  & 0.51 &  0  \\
      0  &   0  & 0.75
  \end{bmatrix}$$     
**即将$R$写成$R=AA'+\Sigma_\varepsilon$的形式**
```{r block9.1.1,comment=''}
R_=matrix(c(1,0.63,0.45,0.63,1,0.35,0.45,0.35,1),nrow=3);R_   
A2=matrix(c(0.9,0.7,0.1),nrow=3);A2       #因子载荷矩阵
e=diag(c(0.19,0.51,0.75));e               #特殊因子的协方差矩阵 
Re=A2%*%t(A2)+e;Re
```

　　可以看到$Re=AA'+\Sigma_\varepsilon$与$R$是相同的。    

### 9.1.1   
　　**计算共同度$h^2_i$，$i=1,2,3$，并解释之。**

```{r block9.1.2,comment=''}　　

```

### 9.1.2    
　　**计算$corr(Z_i,F_1)$，$i=1,2,3$，哪个变量在公共因子中有最大的权？为什么？**     
　　$corr(Z_i,F_j)=a_{ij}$,而载荷矩阵$A$我们已经知道是$\begin{bmatrix}0.9\\0.7\\0.1\end{bmatrix}$，因此$corr(Z_1,F_1)=a_{11}=0.9$，$corr(Z_2,F_1)=a_{21}=0.7$，$corr(Z_3,F_1)=a_{31}=0.1$。$Z_1$在公共因子中有最大的权，因为$Z_1$与$F_1$的相依程度最大。


## 9.2     
　　**编写R程序验证下列矩阵性质：**    
(1)$(I+A'\Omega^{-1}A)^{-1}A'\Omega^{-1}A=I-(I+A'\Omega^{-1}A)^{-1}$    
(2)$(AA'+\Omega)^{-1}=\Omega^{-1}-\Omega^{-1}A(I+A'\Omega^{-1}A)^{-1}A'\Omega^{-1}$    
(3)$A'(AA'+\Omega)^{-1}=(I+A'\Omega^{-1}A)^{-1}A'\Omega^{-1}$    

```{r block9.3.2,comment=''}

```
　　用5*2的载荷矩阵验证可以看到三个等式均成立，也可进行其他阶数的检验。

## 9.3     
　　**试编制计算Bartett因子得分的R语言函数。**

```{r block9.3.1,comment=''}

```

## 9.4     
　　**因子分析法在股价预报上的探索:在本例中为了验证因子分析法的有效性，特意不区分行业，以上海证券交易所和深圳证券交易所进行分层，然后把层内全部股票选入抽样框，已进行随机抽取。从手机金融界（http://www.jrj.com.cn） 得到了23家企业在2004年3月31日，所考虑的指标如下：$X_1$流动比率（<2偏低）、$X_2$速动比率（<1偏低）、$X_3$现金流动负债比（%）、$X_4$每股收益（元）、$X_5$每股未分配利润（元）、$X_6$每股净资产（元）、$X_7$每股资本公积金（元）、$X_8$每股盈余公积金（元）、$X_9$每股净资产增长率（%）、$X_{10}$经营净利润率（%）、$X_{11}$经营毛利率（%）、$X_{12}$资产利润率（%）、$X_{13}$资产净利率（%）、$X_{14}$主营业务收入增长率（%）、$X_{15}$净利润增长率（%）、$X_{16}$总资产增长率（%）、$X_{17}$营业利润增长率（%）、$X_{18}$主营业务成本比例（%）、$X_{19}$营业费用比例（%）、$X_{20}$管理费用比例（%）、$X_{21}$财务费用比率（%）。**   
```{r read9.4,comment=''}

```

### 9.4.1   
　　**求样本相关阵R及特征根与特征向量。**    
```{r block9.4.1,comment=''}

```

### 9.4.2     
　　**确定因子的个数，并解释这些因子的含义。**    
```{r block9.4.2,comment=''}

```

### 9.4.3     
　　**计算各因子得分，画出前两个因子的得分图并作出解释。**         
```{r block9.4.3,comment=''}

```

### 9.4.4    
　　**对因子进行旋转，比较旋转前后因子分析结果。**    
```{r block9.4.4,comment=''}

```

### 9.4.5       
　　**对这23家上市企业的财务状况进行综合评价。**
```{r block9.4.5,comment=''}

```

