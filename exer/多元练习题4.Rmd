---
title: "4 多元相关与回归分析"
author: "王斌会"
date: "2020年2月1日"
output: word_document
---

```{r setup}
rm(list=ls())                               #清理内存
options(digits=4)                           #输出结果位数
par(mar=c(4,4,2,1))                         #设置图片输出位置
library(openxlsx)
library(knitr)
library(leaps)
```

## 4.1
   **一家保险公司十分关心其总公司营业部加班的程度，决定认真调查一下现状。经过10周时间，收集了该公司每周加班工作时间y（小时）的数据和签发的新保单数目x（张），数据见下表。**　　　
```{r read4.1,comment=''}
d4.1=read.xlsx('mvexer5.xlsx',sheet='E4.1')   #读取数据
kable(d4.1)   #显示数据
```

### 4.1.1   
　　**绘制散点图，并以此判断$x$与$y$之间是否大致呈线性关系。**    
```{r block4.1.1,comment=''}

```
### 4.1.2    
　　**计算$x$与$y$的相关系数。**    
```{r block4.1.2,comment=''}

```
### 4.1.3   
　　**用最小二乘估计法求回归方程。**     
```{r block4.1.3,comment=''}

```
### 4.1.4     
　　**求随机误差$\varepsilon$的方差$\sigma^2$的估计值。**     
```{r block4.1.4,comment=''}

```
### 4.1.5   
　　**计算$x$与$y$的决定系数。**    
```{r block4.1.5,comment=''}

```
### 4.1.6    
　　**对回归方程作方差分析。**    
```{r block4.1.6,comment=''}

```
### 4.1.7    
　　**对回归方程作残差图并作一些分析。**     
```{r block4.1.7,comment=''}

```
### 4.1.8    
　　**计算$x_0=1000(张)$时需要的加班时间是多少？**    
```{r block4.1.8,comment=''}

```

## 4.2   
　　**某房地产公司的总裁想了解为什么公司中的某些分公司比其他分公司表现出色，他认为决定总年销售额(以百万元计)的关键因素是广告预算(以千元计)和销售代理的数目。为了分析这种情况，他抽取了八家分公司作为样本，收集了下表所示的数据。**   
```{r read4.2,comment=''}

```
### 4.2.1   
　　**准备一回归模型并解释各系数。**     
```{r block4.2.1,comment=''}

```
### 4.2.2   
　　**试用5%的显著性水平，确定每一解释变量与依赖变量间是否呈线性关系。**　　   
```{r block4.2.2,comment=''}

```
### 4.3.1   
　　**计算相关系数和复相关系数。**     
```{r block4.2.3,comment=''}

```
## 4.3   
　　**预测一学校毕业生的起始工资的变化是否能用学生的平均成绩点数(GPA)和毕业时的年龄来解释。下表所示为其学校办公室提供的样本数据。**    
```{r read4.3,comment=''}

```
### 4.3.1    
　　**准备一回归模型并解释各系数。**    
```{r block4.3.1,comment=''}

```
### 4.3.2   
　　**确定学生的GPA和年龄是否能真正用来解释起始工资样本的变化。**     
```{r block4.3.2,comment=''}

```
### 4.3.3   
　　**预测某GPA为3.00、年龄为24岁的毕业生的起始工资。**    
```{r block4.3.3,comment=''}

```
## 4.4
　　**研究货运总量y(万吨)与工业总产值$x_1$(亿元)、农业总产值$x_2$(亿元)、居民非商品支出$x_3$(亿元)的关系。有关数据见下表。**    
```{r read4.4,comment=''}

```

### 4.4.1    
　　**计算出$y$、$x_1$、$x_2$、$x_3$相关系数矩阵并绘制矩阵散点图。**   
```{r block4.4.1,comment=''}

```
### 4.4.2   
　　**求$y$关于$x_1$、$x_2$、$x_3$的多元线性回归方程。**   
```{r block4.2,comment=''}

```
### 4.4.3    
　　**对所求得的方程作拟合优度检验。**   
```{r block4.4.3,comment=''}

```

### 4.4.4    
　　**对回归方程及每一个回归系数作显著性检验。**    
　　在5%的显著水平下，发现只有$x_2$的t检验p值小于0.05，系数是显著的,截距项、$x_1$和$x_3$的p值都大于0.05，系数不显著。而对整个模型的显著性水平检验即方差分析中可以看到$x_1$和$x_2$的p值都小于0.05，说明模型对$x_1$和$x_2$的回归是有意义的。    
### 4.4.5    
　　**如果有的回归系数没通过显著性检验，将其剔除，重新建立回归方程，再作回归方程的显著性检验和回归系数的显著性检验。**    
```{r block4.4.4,comment=''}
fm4_=lm(y~x2-1,data=d4.4);fm4_     #去掉x1、x3和截距项，只留下x2

```

### 4.4.6    
　　**使用变量选择方法获得一个最优回归模型。**    
```{r block4.4.5,comment=''}

```

```{r block4.4.6,comment=''}

```
